{% extends 'core/base.html' %}
{% load static %}
{% block content %}
<div class="container" >
  <div class="row">
      <div class="col-md-10 col-11 mx-auto" >
          <div class="row mt-4 gx-3" >
              <div class="col-md-6 col-11 mx-auto my-5 " >
                  <p class="text-center mb-4 lead">Already have an account ? <a href="{% url 'login' %}" style="color: rgb(0, 110, 255);text-decoration: none;">Login</a></p>
                  <form method="POST" action="{% url 'register' %}">
                    {% csrf_token %}
                      <div class="mb-3">
                          <label for="userName" class="form-label">Username</label>
                          <div class="input-group">
                              <span class="input-group-text">@</span>
                              <input type="text" class="form-control" id="username" name="username" required>
                              <div class="valid-feedback" id="usname_valid">
                                Looks good!
                              </div>
                              <div class="invalid-feedback" id="usname_invalid">
                                <ul class="list-group list-group-flush">
                                  <li class="list-group-item">Invalid Username</li>
                                  
                                </ul>
                              </div>

                          </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">First Name</label>
                        <input type="text" class="form-control" id="fname" name="fname" required >
                        <div class="valid-feedback" id="usname_valid">
                          Looks good!
                        </div>
                        <div class="invalid-feedback" id="usname_invalid">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Oops!</li>
                          </ul>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">Last Name</label>
                        <input type="text" class="form-control" id="lname" name="lname" required>
                        <div class="valid-feedback" id="usname_valid">
                          Looks good!
                        </div>
                        <div class="invalid-feedback" id="usname_invalid">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Oops!</li>
                          </ul>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label for="exampleInputEmail1" class="form-label">Email address</label>
                        <input type="email" class="form-control" id="email" name="email" aria-describedby="emailHelp" required>
                        <div class="valid-feedback">
                          Looks good!
                        </div>
                        <div class="invalid-feedback">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Please enter a valid email.</li>
                            <li class="list-group-item">Email id must be minimum of 3 to maximum of 25 characters.</li>
                          </ul>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">State</label>
                        <select name="state" id="state" class="form-control" required>
                          
                      </select>
                      <div class="valid-feedback">
                        Looks good!
                      </div>
                      <div class="invalid-feedback">
                        <ul class="list-group list-group-flush">
                          <li class="list-group-item">Enter valid state name</li>
                        </ul>
                      </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">City</label>
                        <input type="text" class="form-control" id="city" name="city" required >
                        <div class="valid-feedback">
                          Looks good!
                        </div>
                        <div class="invalid-feedback">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Enter valid city name</li>
                          </ul>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">Mobile no</label>
                        <div class="input-group">
                          <span class="input-group-text">+91</span>
                        <input type="number" class="form-control" id="pno" name="pno" required>
                        <div class="valid-feedback">
                          Looks good!
                        </div>
                        <div class="invalid-feedback">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Your phone must start with 7,8 or 9.</li>
                            <li class="list-group-item">Your phone no must be of 10 digits.</li>
                          </ul>
                        </div>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">Zipcode</label>
                        <input type="text" class="form-control" id="zipcode" name="zipcode" required>
                        <div class="valid-feedback">
                          Looks good!
                        </div>
                        <div class="invalid-feedback">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Enter valid zipcode</li>
                          </ul>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">Address</label>
                        <textarea type="text" class="form-control" id="address" name="address" required></textarea>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">Password</label>
                        <input type="password" class="form-control" id="password" name="password" required>
                        <a href="#" style="text-decoration: none;" class="my-2"><p>Forgot Password ?</p></a>
                        <div class="valid-feedback">
                          Looks good!
                        </div>
                        <div class="invalid-feedback">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">password must contain 1 number (0-9)</li>
                            <li class="list-group-item">password must contain 1 uppercase letters</li>
                            <li class="list-group-item">password must contain 1 lowercase letters</li>
                            <li class="list-group-item">password must contain 1 non-alpha numeric number</li>
                            <li class="list-group-item">password is 8-16 characters with no space</li>
                          </ul>
                        </div>
                      </div>
                      <div class="mb-3">
                        <label  class="form-label">Check Password</label>
                        <input type="password" class="form-control" id="cpass"name="cpassword" required>
                        <div class="valid-feedback">
                          Passwords match!
                        </div>
                        <div class="invalid-feedback">
                          <ul class="list-group list-group-flush">
                            <li class="list-group-item">Passwords do not match.</li>
                          </ul>
                        </div>
                      </div>
                      <div id="mydiv" style="height: 38px;width: 83.375px;display: inline-block;">
                      <button type="submit"  class="btn btn-primary disabled" id="mybtn">Register</button>
                    </div>
                      
                    </form>
                    
              </div>
           </div>
      </div>

  </div>
</div>




{% block js %}
<script>
  html=''
  $(document).ready(function(){
    $.ajax(
             {
                type:'GET',
                url:'/static/json/states.json/',
             }
         )
         .done(function(data){
           Array.from(data['states']).forEach(function(e){
             html+=`<option value="${e}">${e}</option>`;
             
           });
           document.getElementById('state').innerHTML=html;
           
           
         });
  });
 
  


// form validation

let validations={'usrname':false,'fname':false,'lname':false,'address':false,'email':false,
'zipcode':false,'city':false,'password':false,'cpassword':false,'pno':false}


// username validation
let name = document.getElementById('username');
  
name.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validUsername(username){
  let ren = /^(?!.*\.\.)(?!.*\.$)[^\W][\w.]{0,29}$/;
  let name = document.getElementById('username');
  
  if(ren.test(username)){
    name.classList.remove('is-invalid');
    name.classList.add('is-valid');
    console.log("name matched");
    validations['usrname']=true
    

  }
  else{
    name.classList.remove('is-valid');
    name.classList.add('is-invalid');
    console.log("name not matched");
    
  }
}




// phone number validation
let pno = document.getElementById('pno');
  
pno.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validPhonenumber(phno){
  let rep = /^[7-9][0-9]{9}$/;
  let pno = document.getElementById('pno');
  if(rep.test(phno)){
    pno.classList.remove('is-invalid');
    pno.classList.add('is-valid');
    console.log("no matched");
    validations['pno']=true
    
    

  }
  else{
    pno.classList.remove('is-valid');
    pno.classList.add('is-invalid');
    console.log("no not matched");
    return false
  }

}



// email validation
let email = document.getElementById('email');
  
email.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validEmail(em){
  let ree = /^([a-zA-Z0-9]{4,30})@([a-zA-Z]{5,10})\.([a-zA-Z]{2,5})/;
  let email = document.getElementById('email');
  if(ree.test(em)){
    email.classList.remove('is-invalid');
    email.classList.add('is-valid');
    console.log("email matched");
    validations['email']=true
    

  }
  else{
    email.classList.remove('is-valid');
    email.classList.add('is-invalid');
    console.log("email not matched");
  }

}

// password validation

let password = document.getElementById('password');
  
password.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validPassword(pass){
  let rep = /^(?=.*\d)(?=.*[A-Z])(?=.*[a-z])(?=.*[^\w\d\s:])([^\s]){8,16}$/gm;
  let password = document.getElementById('password');
  if(rep.test(pass)){
    password.classList.remove('is-invalid');
    password.classList.add('is-valid');
    console.log("password matched");
    validations['password']=true
    

  }
  else{
    password.classList.remove('is-valid');
    password.classList.add('is-invalid');
    console.log("password not matched");
  }

}



// zipcode validation

let zipcode = document.getElementById('zipcode');
  
zipcode.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validZipcode(zip){
  let rez = /^[1-9]{1}[0-9]{2}[\s]{0,1}[0-9]{3}$/;
  let zipcode = document.getElementById('zipcode');
  if(rez.test(zip)){
    zipcode.classList.remove('is-invalid');
    zipcode.classList.add('is-valid');
    console.log("zipcode matched");
    validations['zipcode']=true

  }
  else{
    zipcode.classList.remove('is-valid');
    zipcode.classList.add('is-invalid');
    console.log("zipcode not matched");
  }

}
// firstname validation

let fname = document.getElementById('fname');
  
fname.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validFname(fn){
  let ref = /^(?=[a-zA-Z\s]{2,25}$)(?=[a-zA-Z\s])(?:([\w\s*?])\1?(?!\1))+$/;
  let fname = document.getElementById('fname');
  if(ref.test(fn)){
    fname.classList.remove('is-invalid');
    fname.classList.add('is-valid');
    console.log("fname matched");
    validations['fname']=true

  }
  else{
    fname.classList.remove('is-valid');
    fname.classList.add('is-invalid');
    console.log("fname not matched");
  }

}


// lastname validation

let lname = document.getElementById('lname');
  
lname.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validLname(ln){
  let ref = /^(?=[a-zA-Z\s]{2,25}$)(?=[a-zA-Z\s])(?:([\w\s*?])\1?(?!\1))+$/;
  let lname = document.getElementById('lname');
  if(ref.test(ln)){
    lname.classList.remove('is-invalid');
    lname.classList.add('is-valid');
    console.log("lname matched");
    validations['lname']=true

  }
  else{
    lname.classList.remove('is-valid');
    lname.classList.add('is-invalid');
    console.log("lname not matched");
  }

}



// check password
let cpass = document.getElementById('cpass');
  
cpass.addEventListener('focus',function(e){
    if( e.target.classList.contains('is-invalid')){
      e.target.classList.remove('is-invalid')
    }
    if( e.target.classList.contains('is-valid')){
      e.target.classList.remove('is-valid')
    }
    
  });
function validCpassword(pass2,pass1){
  if(pass1 != "" && pass2 != ""){
    if(pass1==pass2){
    cpass.classList.remove('is-invalid');
    cpass.classList.add('is-valid');
    console.log("passwords matched");
    validations['cpassword']=true
  }
  else{
    cpass.classList.remove('is-valid');
    cpass.classList.add('is-invalid');
    console.log("passwords do not match");
  }
  }
  else{
    cpass.classList.remove('is-valid');
    cpass.classList.add('is-invalid');
    console.log("passwords do not match");
  }

}











$('#mydiv').click(function(e){
  username=$('input[name=username]').val();
  password=$('input[name=password]').val();
  cpassword=$('input[name=cpassword]').val();
  email=$('input[name=email]').val();
  zipcode=$('input[name=zipcode]').val();
  address=$('input[name=address]').val();
  pno=$('input[name=pno]').val();
  state=$('select[name=state]').val();
  city=$('input[name=city]').val();
  fname=$('input[name=fname]').val();
  lname=$('input[name=lname]').val();

  validUsername(username);
  validPhonenumber(pno);
  validEmail(email);
  validPassword(password);
  validZipcode(zipcode);
  validFname(fname);
  validLname(lname);
  validCpassword(cpassword,password)

  if(address!="" && city!=""){
    validations['address']=true
    validations['city']=true
  }


 if(validations['usrname']==true && validations['fname']==true &&validations['lname']==true && 
 validations['address']==true &&validations['city']==true && validations['email']==true &&
 validations['pno']==true &&validations['zipcode']==true &&validations['password']==true
  && validations['cpassword']==true){
    e.target.height=0;
    e.target.width=0;
    document.getElementById('mybtn').classList.remove('disabled');
  }
 

  

  
  
  
});














  
</script>





{% endblock %}



{% endblock %}